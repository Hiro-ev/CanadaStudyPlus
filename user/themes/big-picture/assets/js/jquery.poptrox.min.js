/* jquery.poptrox.js v2.5.2-dev | (c) @ajlkn | github.com/ajlkn/jquery.poptrox | MIT licensed */
 !function(e) {
	e.fn.poptrox_disableSelection=function() {
		return e(this).css("user-select", "none").css("-khtml-user-select", "none").css("-moz-user-select", "none").css("-o-user-select", "none").css("-webkit-user-select", "none")
	}

	,
	e.fn.poptrox=function(o) {
		if(0==this.length)return e(this);

		if(this.length>1) {
			for(var t=0; t<this.length; t++)e(this[t]).poptrox(o);
			return e(this)
		}

		var p,
		i,
		s=e.extend( {
				preload: !1, baseZIndex:1e3, fadeSpeed:300, overlayColor:"#000000", overlayOpacity:.6, overlayClass:"poptrox-overlay", windowMargin:50, windowHeightPad:0, selector:"a", caption:null, parent:"body", popupSpeed:300, popupWidth:200, popupHeight:100, popupIsFixed: !1, useBodyOverflow: !1, usePopupEasyClose: !0, usePopupForceClose: !1, usePopupLoader: !0, usePopupCloser: !0, usePopupCaption: !1, usePopupNav: !1, usePopupDefaultStyling: !0, popupBackgroundColor:"#FFFFFF", popupTextColor:"#000000", popupLoaderTextSize:"2em", popupCloserBackgroundColor:"#000000", popupCloserTextColor:"#FFFFFF", popupCloserTextSize:"20px", popupPadding:10, popupCaptionHeight:60, popupCaptionTextSize:null, popupBlankCaptionText:"(untitled)", popupCloserText:"&#215;", popupLoaderText:"&bull;&bull;&bull;&bull;", popupClass:"poptrox-popup", popupSelector:null, popupLoaderSelector:".loader", popupCloserSelector:".closer", popupCaptionSelector:".caption", popupNavPreviousSelector:".nav-previous", popupNavNextSelector:".nav-next", onPopupClose:null, onPopupOpen:null
			}

			, o),
		r=e(this),
		n=e("body"),
		a=e('<div class="'+s.overlayClass+'"></div>'),
		l=e(window),
		u=[],
		d=0,
		h= !1,
		g=new Array,
		f=function() {
			p=l.width(),
			i=l.height()+s.windowHeightPad;
			var e=Math.abs(x.width()-x.outerWidth()),
			o=Math.abs(x.height()-x.outerHeight()),
			t=p-2*s.windowMargin-e,
			r=i-2*s.windowMargin-o;
			x.css("min-width", s.popupWidth).css("min-height", s.popupHeight),
			v.children().css("max-width", t).css("max-height", r)
		}

		;
		s.usePopupLoader||(s.popupLoaderSelector=null),
		s.usePopupCloser||(s.popupCloserSelector=null),
		s.usePopupCaption||(s.popupCaptionSelector=null),
		s.usePopupNav||(s.popupNavPreviousSelector=null, s.popupNavNextSelector=null);
		var x;
		x=e(s.popupSelector?s.popupSelector:'<div class="'+s.popupClass+'">'+(s.popupLoaderSelector?'<div class="loader">'+s.popupLoaderText+"</div>":"")+'<div class="pic"></div>'+(s.popupCaptionSelector?'<div class="caption"></div>':"")+(s.popupCloserSelector?'<span class="closer">'+s.popupCloserText+"</span>":"")+(s.popupNavPreviousSelector?'<div class="nav-previous"></div>':"")+(s.popupNavNextSelector?'<div class="nav-next"></div>':"")+"</div>");
		var v=x.find(".pic"),
		w=e(),
		b=x.find(s.popupLoaderSelector),
		m=x.find(s.popupCaptionSelector),
		C=x.find(s.popupCloserSelector),
		y=x.find(s.popupNavNextSelector),
		S=x.find(s.popupNavPreviousSelector),
		P=y.add(S);

		if(s.usePopupDefaultStyling&&(x.css("background", s.popupBackgroundColor).css("color", s.popupTextColor).css("padding", s.popupPadding+"px"), m.length>0&&(x.css("padding-bottom", s.popupCaptionHeight+"px"), m.css("position", "absolute").css("left", "0").css("bottom", "0").css("width", "100%").css("text-align", "center").css("height", s.popupCaptionHeight+"px").css("line-height", s.popupCaptionHeight+"px"), s.popupCaptionTextSize&&m.css("font-size", popupCaptionTextSize)), C.length>0&&C.html(s.popupCloserText).css("font-size", s.popupCloserTextSize).css("background", s.popupCloserBackgroundColor).css("color", s.popupCloserTextColor).css("display", "block").css("width", "40px").css("height", "40px").css("line-height", "40px").css("text-align", "center").css("position", "absolute").css("text-decoration", "none").css("outline", "0").css("top", "0").css("right", "-40px"), b.length>0&&b.html("").css("position", "relative").css("font-size", s.popupLoaderTextSize).on("startSpinning", function(o) {
						var t=e("<div>"+s.popupLoaderText+"</div>"); t.css("height", Math.floor(s.popupHeight/2)+"px").css("overflow", "hidden").css("line-height", Math.floor(s.popupHeight/2)+"px").css("text-align", "center").css("margin-top", Math.floor((x.height()-t.height()+(m.length>0?m.height():0))/2)).css("color", s.popupTextColor?s.popupTextColor:"").on("xfin", function() {
								t.fadeTo(300, .5, function() {
										t.trigger("xfout")
									}

								)
							}

						).on("xfout", function() {
								t.fadeTo(300, .05, function() {
										t.trigger("xfin")
									}

								)
							}

						).trigger("xfin"), b.append(t)
					}

				).on("stopSpinning", function(e) {
						var o=b.find("div"); o.remove()
					}

				), 2==P.length)) {
			P.css("font-size", "75px").css("text-align", "center").css("color", "#fff").css("text-shadow", "none").css("height", "100%").css("position", "absolute").css("top", "0").css("opacity", "0.35").css("cursor", "pointer").css("box-shadow", "inset 0px 0px 10px 0px rgba(0,0,0,0)").poptrox_disableSelection();
			var k,
			T;
			s.usePopupEasyClose?(k="100px", T="100px"): (k="75%", T="25%"), y.css("right", "0").css("width", k).html('<div style="position: absolute; height: 100px; width: 125px; top: 50%; right: 0; margin-top: -50px;">&gt;</div>'), S.css("left", "0").css("width", T).html('<div style="position: absolute; height: 100px; width: 125px; top: 50%; left: 0; margin-top: -50px;">&lt;</div>')
		}

		return l.on("resize orientationchange", function() {
				f()
			}

		),
		m.on("update", function(e, o) {
				o&&0 !=o.length||(o=s.popupBlankCaptionText), m.html(o)
			}

		),
		C.css("cursor", "pointer").on("click", function(e) {
				return e.stopPropagation(), x.trigger("poptrox_close"),  !0
			}

		),
		y.on("click", function(e) {
				e.stopPropagation(), e.preventDefault(), x.trigger("poptrox_next")
			}

		),
		S.on("click", function(e) {
				e.stopPropagation(), e.preventDefault(), x.trigger("poptrox_previous")
			}

		),
		a.css("position", "fixed").css("left", 0).css("top", 0).css("z-index", s.baseZIndex).css("width", "100%").css("height", "100%").css("text-align", "center").css("cursor", "pointer").appendTo(s.parent).prepend('<div style="display:inline-block;height:100%;vertical-align:middle;"></div>').append('<div style="position:absolute;left:0;top:0;width:100%;height:100%;background:'+s.overlayColor+";opacity:"+s.overlayOpacity+";filter:alpha(opacity="+100*s.overlayOpacity+');"></div>').hide().on("touchmove", function(e) {
				return !1
			}

		).on("click", function(e) {
				e.preventDefault(), e.stopPropagation(), x.trigger("poptrox_close")
			}

		),
		x.css("display", "inline-block").css("vertical-align", "middle").css("position", "relative").css("z-index", 1).css("cursor", "auto").appendTo(a).hide().on("poptrox_next", function() {
				var e=d+1; e>=u.length&&(e=0), x.trigger("poptrox_switch", [e])
			}

		).on("poptrox_previous", function() {
				var e=d-1; e<0&&(e=u.length-1), x.trigger("poptrox_switch", [e])
			}

		).on("poptrox_reset", function() {
				f(), x.data("width", s.popupWidth).data("height", s.popupHeight), b.hide().trigger("stopSpinning"), m.hide(), C.hide(), P.hide(), v.hide(), w.attr("src", "").detach()
			}

		).on("poptrox_open", function(e, o) {
				return ! !h||(h= !0, s.useBodyOverflow&&n.css("overflow", "hidden"), s.onPopupOpen&&s.onPopupOpen(), x.addClass("loading"), void a.fadeTo(s.fadeSpeed, 1, function() {
							x.trigger("poptrox_switch", [o,  !0])
						}

					))
			}

		).on("poptrox_switch", function(o, t, p) {
				var i; if( !p&&h)return !0; if(h= !0, x.addClass("loading").css("width", x.data("width")).css("height", x.data("height")), m.hide(), w.attr("src")&&w.attr("src", ""), w.detach(), i=u[t], w=i.object, w.off("load"), v.css("text-indent", "-9999px").show().append(w), "ajax"==i.type?e.get(i.src, function(e) {
							w.html(e), w.trigger("load")
						}

					):w.attr("src", i.src), "image" !=i.type) {
					var r, n; r=i.width, n=i.height, "%"==r.slice(-1)&&(r=parseInt(r.substring(0, r.length-1))/100*l.width()), "%"==n.slice(-1)&&(n=parseInt(n.substring(0, n.length-1))/100*l.height()), w.css("width", r+"px").css("height", n+"px")
				}

				else w.css("max-width", l.width()+"px").css("max-height", l.height()+"px").css("width", "auto").css("height", "auto"); w.trigger("load"), b.show().trigger("startSpinning"), d=t, f()
			}

		),
		r.find(s.selector).each(function(o) {
				var t=e(this), i=t.attr("href"), r=t.attr("data-caption"); if(i&&i.length>0) {
					var n= {
						src:i, caption:r, type:"image"
					}

					; u.push(n), t.removeAttr("href").css("cursor", "pointer").css("outline", 0).on("click", function(e) {
							e.stopPropagation(), x.trigger("poptrox_open", [o])
						}

					)
				}
			}

		),
		this
	}
}
(jQuery);